(function(){var e={2634:function(){},4125:function(e,t,l){"use strict";var o=l(5130),a=l(6768),s=l(4232);const r={class:"logo"},i={class:"header-left"},n={class:"header-right"},d={class:"user-info"},u={class:"username"};function c(e,t,l,o,c,m){const g=(0,a.g2)("Setting"),h=(0,a.g2)("el-icon"),p=(0,a.g2)("House"),b=(0,a.g2)("el-menu-item"),f=(0,a.g2)("UserFilled"),k=(0,a.g2)("Picture"),_=(0,a.g2)("Link"),F=(0,a.g2)("Tools"),y=(0,a.g2)("el-sub-menu"),v=(0,a.g2)("Bell"),w=(0,a.g2)("el-menu"),L=(0,a.g2)("el-aside"),V=(0,a.g2)("el-breadcrumb-item"),U=(0,a.g2)("el-breadcrumb"),T=(0,a.g2)("el-avatar"),C=(0,a.g2)("SwitchButton"),$=(0,a.g2)("el-dropdown-item"),W=(0,a.g2)("el-dropdown-menu"),x=(0,a.g2)("el-dropdown"),D=(0,a.g2)("el-header"),R=(0,a.g2)("router-view"),A=(0,a.g2)("el-main"),B=(0,a.g2)("el-footer"),I=(0,a.g2)("el-container");return(0,a.uX)(),(0,a.Wv)(I,{class:"layout-container"},{default:(0,a.k6)(()=>[(0,a.bF)(L,{width:"220px",class:"sidebar"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",r,[(0,a.bF)(h,{size:"30",color:"#409EFF"},{default:(0,a.k6)(()=>[(0,a.bF)(g)]),_:1}),t[0]||(t[0]=(0,a.Lk)("span",{class:"logo-title"},"管理系统",-1))]),(0,a.bF)(w,{"default-active":e.$route.path,class:"sidebar-menu",router:!0,"background-color":"#545c64","text-color":"#fff","active-text-color":"#409EFF"},{default:(0,a.k6)(()=>[(0,a.bF)(b,{index:"/",route:{name:"home"}},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(p)]),_:1}),t[1]||(t[1]=(0,a.Lk)("span",null,"首页",-1))]),_:1}),m.has_permission("user")?((0,a.uX)(),(0,a.Wv)(b,{key:0,index:"/users",route:{name:"users"}},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(f)]),_:1}),t[2]||(t[2]=(0,a.Lk)("span",null,"用户管理",-1))]),_:1})):(0,a.Q3)("",!0),m.has_permission("banner")?((0,a.uX)(),(0,a.Wv)(b,{key:1,index:"/banners",route:{name:"banners"}},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(k)]),_:1}),t[3]||(t[3]=(0,a.Lk)("span",null,"轮播图管理",-1))]),_:1})):(0,a.Q3)("",!0),m.has_permission("link")?((0,a.uX)(),(0,a.Wv)(b,{key:2,index:"/links",route:{name:"links"}},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(_)]),_:1}),t[4]||(t[4]=(0,a.Lk)("span",null,"链接管理",-1))]),_:1})):(0,a.Q3)("",!0),m.has_permission("tool")?((0,a.uX)(),(0,a.Wv)(y,{key:3,index:"/tools"},{title:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(F)]),_:1}),t[5]||(t[5]=(0,a.Lk)("span",null,"工具管理",-1))]),default:(0,a.k6)(()=>[(0,a.bF)(b,{index:"/tools/list",route:{name:"toolmanagement"}},{default:(0,a.k6)(()=>[...t[6]||(t[6]=[(0,a.eW)("工具列表",-1)])]),_:1}),(0,a.bF)(b,{index:"/tools/type",route:{name:"tooltype"}},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("工具分类",-1)])]),_:1})]),_:1})):(0,a.Q3)("",!0),m.has_permission("announce")?((0,a.uX)(),(0,a.Wv)(y,{key:4,index:"/announcements"},{title:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(v)]),_:1}),t[8]||(t[8]=(0,a.Lk)("span",null,"公告管理",-1))]),default:(0,a.k6)(()=>[(0,a.bF)(b,{index:"/announcements/list",route:{name:"announcelist"}},{default:(0,a.k6)(()=>[...t[9]||(t[9]=[(0,a.eW)("公告列表",-1)])]),_:1}),(0,a.bF)(b,{index:"/announcements/add",route:{name:"announceadd"}},{default:(0,a.k6)(()=>[...t[10]||(t[10]=[(0,a.eW)("发布公告",-1)])]),_:1})]),_:1})):(0,a.Q3)("",!0)]),_:1},8,["default-active"])]),_:1}),(0,a.bF)(I,null,{default:(0,a.k6)(()=>[(0,a.bF)(D,{class:"header"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",i,[(0,a.bF)(U,{separator:"/"},{default:(0,a.k6)(()=>[(0,a.bF)(V,{to:{path:"/"}},{default:(0,a.k6)(()=>[...t[11]||(t[11]=[(0,a.eW)("首页",-1)])]),_:1}),(0,a.bF)(V,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(m.currentPageTitle),1)]),_:1})]),_:1})]),(0,a.Lk)("div",n,[(0,a.bF)(x,null,{dropdown:(0,a.k6)(()=>[(0,a.bF)(W,null,{default:(0,a.k6)(()=>[(0,a.bF)($,{onClick:m.logout},{default:(0,a.k6)(()=>[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(C)]),_:1}),t[12]||(t[12]=(0,a.eW)("退出登录 ",-1))]),_:1},8,["onClick"])]),_:1})]),default:(0,a.k6)(()=>[(0,a.Lk)("div",d,[(0,a.bF)(T,{size:"small",src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}),(0,a.Lk)("span",u,(0,s.v_)(this.$auth.user.username)+"【"+(0,s.v_)(e.$auth.user.role.name)+"】",1)])]),_:1})])]),_:1}),(0,a.bF)(A,{class:"main-content"},{default:(0,a.k6)(()=>[(0,a.bF)(R)]),_:1}),(0,a.bF)(B,{class:"footer"},{default:(0,a.k6)(()=>[...t[13]||(t[13]=[(0,a.Lk)("p",null,"© 2025 后台管理系统 - 由 Element Plus 驱动",-1)])]),_:1})]),_:1})]),_:1})}var m={name:"App",computed:{currentPageTitle(){const e={"/":"首页","/users":"用户管理","/banners":"轮播图管理","/links":"链接管理","/tools/list":"工具列表","/tools/type":"工具分类","/announcements/list":"公告列表","/announcements/add":"发布公告"};return e[this.$route.path]||"首页"}},mounted(){this.$auth.is_active||(window.location.href=this.$http.server_host)},methods:{has_permission(e){return this.$auth.user.permissions.indexOf(e)>=0},logout(){this.$auth.clearUserToken(),window.location.href=this.$http.server_host+"/login"}}},g=l(1241);const h=(0,g.A)(m,[["render",c],["__scopeId","data-v-41ba496a"]]);var p=h,b=l(7477),f=l(6131),k=(l(4188),l(8512));function _(e,t,l,o,s,r){return t[0]||(t[0]=(0,a.Fv)('<h1 data-v-4f949b18>首页</h1><div class="home-view" data-v-4f949b18><div class="lines" data-v-4f949b18><div class="line-web-access" id="webaccess" data-v-4f949b18></div></div><div class="pies" data-v-4f949b18><div class="pie-tools" id="tools" data-v-4f949b18></div></div><div class="gauges" data-v-4f949b18><h2 class="gauge-title" data-v-4f949b18>服务器指标</h2><div class="gauge-cpu" id="cpu" data-v-4f949b18></div><div class="gauge-memory" id="memory" data-v-4f949b18></div></div><div class="bars" data-v-4f949b18><div class="bar-access-announce" id="announces" data-v-4f949b18></div></div></div>',2))}var F=l(9041),y=l(1219),v={name:"HomeView",mounted(){this.initWebAccess(),this.initGaugeCPU(),this.initGaugeMEM(),this.initPieTools(),this.initBarAccessAnnounce()},methods:{initWebAccess(){this.$http.getWebAccessInfo().then(e=>{var t,l=e.data.xAxis_data,o=e.data.yAxis_data,a=document.getElementById("webaccess"),s=F.Ts(a);t={title:{text:"近期网站访问量"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:l},yAxis:{type:"value"},series:[{data:o,type:"line",smooth:!0}]},t&&s.setOption(t)})},initGaugeCPU(){this.$http.getSysInfo().then(e=>{var t,l=e.data.cpu_usage,o=document.getElementById("cpu"),a=F.Ts(o);t={tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"Pressure",type:"gauge",progress:{show:!0},detail:{valueAnimation:!0,formatter:"{value}"},data:[{value:l,name:"CPU使用率"}]}]},t&&a.setOption(t)})},initGaugeMEM(){this.$http.getSysInfo().then(e=>{var t,l=e.data.mem_usage,o=document.getElementById("memory"),a=F.Ts(o);t={tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"Pressure",type:"gauge",progress:{show:!0},detail:{valueAnimation:!0,formatter:"{value}"},data:[{value:l,name:"内存使用率"}]}]},t&&a.setOption(t)})},initPieTools(){this.$http.getToolMemu().then(e=>{if(200==e["code"]){var t,l=e.data,o=document.getElementById("tools"),a=F.Ts(o);t={title:{text:"工具类型分布",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[{name:"工具类型",type:"pie",radius:"50%",data:l,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},t&&a.setOption(t)}else y.nk.error(e["message"])})},initBarAccessAnnounce(){this.$http.getToolUsageCount().then(e=>{var t,l=e.data.xAxis_data,o=e.data.yAxis_data,a=document.getElementById("announces"),s=F.Ts(a);t={title:{text:"工具使用次数"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:l,axisLabel:{rotate:45,interval:0}},yAxis:{type:"value"},series:[{data:o,type:"bar"}]},t&&s.setOption(t)})}}};const w=(0,g.A)(v,[["render",_],["__scopeId","data-v-4f949b18"]]);var L=w;const V={class:"user-management"},U={class:"toolbar"},T={class:"pagination-container"},C={class:"dialog-footer"},$={class:"dialog-footer"},W={class:"dialog-footer"};function x(e,t,l,o,r,i){const n=(0,a.g2)("el-button"),d=(0,a.g2)("el-table-column"),u=(0,a.g2)("el-tag"),c=(0,a.g2)("el-table"),m=(0,a.g2)("el-pagination"),g=(0,a.g2)("el-input"),h=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-option"),b=(0,a.g2)("el-select"),f=(0,a.g2)("el-form"),k=(0,a.g2)("el-dialog"),_=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("div",U,[i.canManageUsers?((0,a.uX)(),(0,a.Wv)(n,{key:0,type:"primary",onClick:i.openAddUserDialog},{default:(0,a.k6)(()=>[...t[12]||(t[12]=[(0,a.eW)(" 添加用户 ",-1)])]),_:1},8,["onClick"])):(0,a.Q3)("",!0)]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{data:r.userList,style:{width:"100%"}},{default:(0,a.k6)(()=>[(0,a.bF)(d,{prop:"username",label:"用户名"}),(0,a.bF)(d,{prop:"realname",label:"真实姓名"}),(0,a.bF)(d,{label:"角色"},{default:(0,a.k6)(e=>[255==e.row.role.permissions?((0,a.uX)(),(0,a.Wv)(u,{key:0,type:"danger"},{default:(0,a.k6)(()=>[...t[13]||(t[13]=[(0,a.eW)("超级管理员",-1)])]),_:1})):16==e.row.role.permissions?((0,a.uX)(),(0,a.Wv)(u,{key:1,type:"primary"},{default:(0,a.k6)(()=>[...t[14]||(t[14]=[(0,a.eW)("公告管理员",-1)])]),_:1})):44==e.row.role.permissions?((0,a.uX)(),(0,a.Wv)(u,{key:2,type:"primary"},{default:(0,a.k6)(()=>[...t[15]||(t[15]=[(0,a.eW)("工具管理员",-1)])]),_:1})):62==e.row.role.permissions?((0,a.uX)(),(0,a.Wv)(u,{key:3,type:"warning"},{default:(0,a.k6)(()=>[...t[16]||(t[16]=[(0,a.eW)("网站管理员",-1)])]),_:1})):((0,a.uX)(),(0,a.Wv)(u,{key:4,type:"info"},{default:(0,a.k6)(()=>[...t[17]||(t[17]=[(0,a.eW)("普通用户",-1)])]),_:1}))]),_:1}),(0,a.bF)(d,{label:"状态"},{default:(0,a.k6)(e=>[(0,a.bF)(u,{type:e.row.is_active?"success":"danger"},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_active?"激活":"禁用"),1)]),_:2},1032,["type"])]),_:1}),(0,a.bF)(d,{prop:"join_time",label:"注册时间"},{default:(0,a.k6)(e=>[(0,a.eW)((0,s.v_)(i.formatDate(e.row.join_time)),1)]),_:1}),(0,a.bF)(d,{label:"操作",width:"250"},{default:(0,a.k6)(e=>[i.canOperateUser(e.row)?((0,a.uX)(),(0,a.Wv)(n,{key:0,size:"small",type:e.row.is_active?"danger":"success",onClick:t=>i.toggleUserStatus(e.row)},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_active?"禁用":"激活"),1)]),_:2},1032,["type","onClick"])):(0,a.Q3)("",!0),i.canOperateUser(e.row)?((0,a.uX)(),(0,a.Wv)(n,{key:1,size:"small",type:"primary",onClick:t=>i.openEditRoleDialog(e.row)},{default:(0,a.k6)(()=>[...t[18]||(t[18]=[(0,a.eW)(" 修改角色 ",-1)])]),_:1},8,["onClick"])):(0,a.Q3)("",!0),i.canOperateUser(e.row)?((0,a.uX)(),(0,a.Wv)(n,{key:2,size:"small",type:"danger",onClick:t=>i.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[19]||(t[19]=[(0,a.eW)(" 删除 ",-1)])]),_:1},8,["onClick"])):(0,a.Q3)("",!0)]),_:1})]),_:1},8,["data"])),[[_,r.loading]]),(0,a.Lk)("div",T,[r.total>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,onCurrentChange:i.handlePageChange,"current-page":r.currentPage,"page-size":r.pageSize,layout:"total, prev, pager, next",total:r.total},null,8,["onCurrentChange","current-page","page-size","total"])):(0,a.Q3)("",!0)]),(0,a.bF)(k,{title:"添加用户",modelValue:r.addUserDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>r.addUserDialogVisible=e),width:"500px",onClose:i.resetAddUserForm},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",C,[(0,a.bF)(n,{onClick:t[4]||(t[4]=e=>r.addUserDialogVisible=!1)},{default:(0,a.k6)(()=>[...t[20]||(t[20]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"primary",onClick:i.submitAddUserForm},{default:(0,a.k6)(()=>[...t[21]||(t[21]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(f,{model:r.addUserForm,rules:r.addUserFormRules,ref:"addUserFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{label:"用户名",prop:"username"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.addUserForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>r.addUserForm.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"密码",prop:"password"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.addUserForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>r.addUserForm.password=e),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"真实姓名",prop:"realname"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.addUserForm.realname,"onUpdate:modelValue":t[2]||(t[2]=e=>r.addUserForm.realname=e),placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"角色",prop:"role_id"},{default:(0,a.k6)(()=>[(0,a.bF)(b,{modelValue:r.addUserForm.role_id,"onUpdate:modelValue":t[3]||(t[3]=e=>r.addUserForm.role_id=e),placeholder:"请选择角色",disabled:!i.canSelectRole},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.availableRoles,e=>((0,a.uX)(),(0,a.Wv)(p,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","onClose"]),(0,a.bF)(k,{title:"修改用户角色",modelValue:r.editRoleDialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>r.editRoleDialogVisible=e),width:"500px"},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",$,[(0,a.bF)(n,{onClick:t[8]||(t[8]=e=>r.editRoleDialogVisible=!1)},{default:(0,a.k6)(()=>[...t[22]||(t[22]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"primary",onClick:i.submitRoleForm},{default:(0,a.k6)(()=>[...t[23]||(t[23]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(f,{model:r.userRoleForm,rules:r.roleFormRules,ref:"userRoleFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{label:"用户名"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.userRoleForm.username,"onUpdate:modelValue":t[6]||(t[6]=e=>r.userRoleForm.username=e),disabled:""},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"角色",prop:"role"},{default:(0,a.k6)(()=>[(0,a.bF)(b,{modelValue:r.userRoleForm.role,"onUpdate:modelValue":t[7]||(t[7]=e=>r.userRoleForm.role=e),placeholder:"请选择角色"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{label:"网站管理员",value:"webuser"}),(0,a.bF)(p,{label:"工具管理员",value:"tooluser"}),(0,a.bF)(p,{label:"公告管理员",value:"announceuser"}),(0,a.bF)(p,{label:"普通用户",value:"user"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),(0,a.bF)(k,{title:"提示",modelValue:r.deleteUserVisible,"onUpdate:modelValue":t[11]||(t[11]=e=>r.deleteUserVisible=e),width:"300px",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",W,[(0,a.bF)(n,{onClick:t[10]||(t[10]=e=>r.deleteUserVisible=!1)},{default:(0,a.k6)(()=>[...t[24]||(t[24]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"danger",onClick:i.confirmDelete},{default:(0,a.k6)(()=>[...t[25]||(t[25]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[t[26]||(t[26]=(0,a.Lk)("span",null,"确定要删除这个用户吗？",-1))]),_:1},8,["modelValue"])])}l(4114),l(8111),l(3579);var D={name:"UserManagement",data(){return{loading:!1,userList:[],total:0,currentPage:1,pageSize:10,deleteUserVisible:!1,editRoleDialogVisible:!1,addUserDialogVisible:!1,currentUser:null,userRoleForm:{username:"",role:""},addUserForm:{username:"",password:"111111",realname:"",role_id:1},roleFormRules:{role:[{required:!0,message:"请选择角色",trigger:"change"}]},addUserFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度至少6位",trigger:"blur"}],realname:[{required:!0,message:"请输入真实姓名",trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}]}}},computed:{loggedInUser(){return this.$auth.user},canManageUsers(){return!!this.loggedInUser&&(!(!this.loggedInUser.role||"超级管理员"!==this.loggedInUser.role.name)||!(!this.loggedInUser.role||"网站管理员"!==this.loggedInUser.role.name))},availableRoles(){const e=[];return e.push({label:"普通用户",value:5}),this.loggedInUser.role&&"网站管理员"===this.loggedInUser.role.name?(e.push({label:"工具管理员",value:3}),e.push({label:"公告管理员",value:2}),e):this.loggedInUser.role&&"超级管理员"===this.loggedInUser.role.name?(e.push({label:"工具管理员",value:3}),e.push({label:"公告管理员",value:2}),e.push({label:"网站管理员",value:4}),e):e},canSelectRole(){return this.availableRoles.length>1||1===this.availableRoles.length&&this.addUserForm.role_id!==this.availableRoles[0].value}},mounted(){this.loadUserList(1)},methods:{async loadUserList(e){this.loading=!0;try{const t=await this.$http.getUserList(e);200===t.code?t.data.user_list.length>0?(this.userList=t.data.user_list,this.total=t.data.total_count):(this.userList=[],this.total=0):this.$message.error(t.message||"获取用户列表失败")}catch(t){this.$message.error("加载用户列表失败")}finally{this.loading=!1}},handlePageChange(e){this.currentPage=e,this.loadUserList(e)},canOperateUser(e){return!!this.canManageUsers&&("普通用户"!==this.loggedInUser.role.name&&"工具管理员"!==this.loggedInUser.role.name&&"公告管理员"!==this.loggedInUser.role.name&&(("超级管理员"!==this.loggedInUser.role.name||this.loggedInUser.id!==e.id)&&("网站管理员"!==this.loggedInUser.role.name||"网站管理员"!==e.role.name&&"超级管理员"!==e.role.name)))},async toggleUserStatus(e){if(this.canOperateUser(e))try{const t=e.is_active?0:1,l=await this.$http.activeUser(e.id,t);200===l.code?(this.$message.success((e.is_active?"禁用":"激活")+"用户成功"),this.loadUserList()):this.$message.error(l.message||(e.is_active?"禁用":"激活")+"用户失败")}catch(t){this.$message.error("更新用户状态失败")}else this.$message.error("您没有权限执行此操作")},openAddUserDialog(){this.addUserDialogVisible=!0,this.availableRoles.length>0&&(this.addUserForm.role_id=this.availableRoles[0].value)},resetAddUserForm(){this.addUserForm={username:"",password:"111111",realname:"",role_id:this.availableRoles.length>0?this.availableRoles[0].value:1},this.$refs.addUserFormRef&&this.$refs.addUserFormRef.resetFields()},submitAddUserForm(){this.$refs.addUserFormRef.validate(async e=>{if(e){const e=this.availableRoles.some(e=>e.value===this.addUserForm.role_id);if(!e)return void this.$message.error("您没有权限添加该角色的用户");try{const e=await this.$http.addUser(this.addUserForm);200===e.code?(this.$message.success("添加用户成功"),this.addUserDialogVisible=!1,this.resetAddUserForm(),this.loadUserList()):this.$message.error(e.message||"添加用户失败")}catch(t){this.$message.error("添加用户失败")}}})},openEditRoleDialog(e){this.canOperateUser(e)?(this.currentUser=e,this.userRoleForm.username=e.username,this.userRoleForm.role="",this.editRoleDialogVisible=!0):this.$message.error("您没有权限执行此操作")},submitRoleForm(){this.$refs.userRoleFormRef.validate(async e=>{if(e)try{let e={id:this.currentUser.id};switch(this.userRoleForm.role){case"superuser":e.role_id=1,e.permissions=255;break;case"webuser":e.role_id=4,e.permissions=62;break;case"tooluser":e.role_id=3,e.permissions=44;break;case"announceuser":e.role_id=2,e.permissions=16;break;case"user":e.role_id=5,e.permissions=1;break}const t=await this.$http.updateUserRole(e);200===t.code?(this.$message.success("修改角色成功"),this.editRoleDialogVisible=!1,this.loadUserList(1)):this.$message.error(t.message||"修改角色失败")}catch(t){this.$message.error("修改角色失败")}})},openDeleteDialog(e){this.canOperateUser(e)?(this.currentUser=e,this.deleteUserVisible=!0):this.$message.error("您没有权限执行此操作")},async confirmDelete(){try{const e=await this.$http.deleteUser(this.currentUser.id);200===e.code?(this.$message.success("删除成功"),this.deleteUserVisible=!1,this.loadUserList()):this.$message.error(e.message||"删除失败")}catch(e){this.$message.error("删除用户失败")}},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()}}};const R=(0,g.A)(D,[["render",x],["__scopeId","data-v-49f9f604"]]);var A=R;const B={class:"banner-management"},I={class:"toolbar"},S={class:"image-upload-container"},E={class:"dialog-footer"},X={class:"dialog-footer"};function P(e,t,l,o,s,r){const i=(0,a.g2)("el-button"),n=(0,a.g2)("el-table-column"),d=(0,a.g2)("el-image"),u=(0,a.g2)("el-table"),c=(0,a.g2)("el-input"),m=(0,a.g2)("el-form-item"),g=(0,a.g2)("el-upload"),h=(0,a.g2)("el-form"),p=(0,a.g2)("el-dialog"),b=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",B,[(0,a.Lk)("div",I,[(0,a.bF)(i,{type:"primary",onClick:r.openAddDialog},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("添加轮播图",-1)])]),_:1},8,["onClick"])]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(u,{data:s.bannerList,style:{width:"100%"}},{default:(0,a.k6)(()=>[(0,a.bF)(n,{prop:"name",label:"轮播图名称"}),(0,a.bF)(n,{prop:"image_url",label:"轮播图URL"},{default:(0,a.k6)(e=>[e.row.image_url?((0,a.uX)(),(0,a.Wv)(d,{key:0,src:this.$http.server_host+e.row.image_url,fit:"cover",style:{width:"100px",height:"60px"},"preview-src-list":[e.row.image_url]},null,8,["src","preview-src-list"])):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(n,{prop:"link_url",label:"跳转链接","show-overflow-tooltip":""}),(0,a.bF)(n,{label:"操作",width:"200"},{default:(0,a.k6)(e=>[(0,a.bF)(i,{size:"small",onClick:t=>r.openEditDialog(e.row)},{default:(0,a.k6)(()=>[...t[8]||(t[8]=[(0,a.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,a.bF)(i,{size:"small",type:"danger",onClick:t=>r.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[9]||(t[9]=[(0,a.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[b,s.loading]]),(0,a.bF)(p,{title:s.dialogTitle,modelValue:s.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>s.dialogVisible=e),width:"500px",onClose:r.resetForm},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",E,[(0,a.bF)(i,{onClick:t[3]||(t[3]=e=>s.dialogVisible=!1)},{default:(0,a.k6)(()=>[...t[11]||(t[11]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(i,{type:"primary",onClick:r.submitForm},{default:(0,a.k6)(()=>[...t[12]||(t[12]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(h,{model:s.bannerForm,rules:s.formRules,ref:"bannerFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{label:"轮播图名称",prop:"name"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:s.bannerForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.bannerForm.name=e),placeholder:"请输入图片名称"},null,8,["modelValue"])]),_:1}),(0,a.bF)(m,{label:"轮播图URL",prop:"image_url"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",S,[(0,a.bF)(c,{modelValue:s.bannerForm.image_url,"onUpdate:modelValue":t[1]||(t[1]=e=>s.bannerForm.image_url=e),placeholder:"请输入图片URL或上传图片",style:{"margin-right":"10px"}},null,8,["modelValue"]),(0,a.bF)(g,{class:"upload-demo",action:r.uploadUrl,headers:r.uploadHeaders,name:"image_url","show-file-list":!1,"on-success":r.handleUploadSuccess,"on-error":r.handleUploadError,"before-upload":r.beforeUpload,accept:"image/jpeg,image/png,image/jpg"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{type:"primary",size:"small",style:{height:"auto"}},{default:(0,a.k6)(()=>[...t[10]||(t[10]=[(0,a.eW)("上传图片",-1)])]),_:1})]),_:1},8,["action","headers","on-success","on-error","before-upload"])])]),_:1}),(0,a.bF)(m,{label:"跳转链接",prop:"link_url"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:s.bannerForm.link_url,"onUpdate:modelValue":t[2]||(t[2]=e=>s.bannerForm.link_url=e),placeholder:"请输入图片跳转链接"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"]),(0,a.bF)(p,{title:"提示",modelValue:s.deleteBannerVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>s.deleteBannerVisible=e),width:"300px",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",X,[(0,a.bF)(i,{onClick:t[5]||(t[5]=e=>s.deleteBannerVisible=!1)},{default:(0,a.k6)(()=>[...t[13]||(t[13]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(i,{type:"danger",onClick:r.confirmDelete},{default:(0,a.k6)(()=>[...t[14]||(t[14]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[t[15]||(t[15]=(0,a.Lk)("span",null,"确定要删除这个轮播图吗？",-1))]),_:1},8,["modelValue"])])}var O={name:"BannerManagement",data(){return{loading:!1,bannerList:[],dialogVisible:!1,deleteBannerVisible:!1,dialogTitle:"添加轮播图",currentBanner:null,bannerForm:{name:"",image_url:"",link_url:""},formRules:{name:[{required:!0,message:"请输入轮播图名称",trigger:"blur"}],image_url:[{required:!0,message:"请输入轮播图URL",trigger:"blur"}],link_url:[{required:!0,message:"请输入跳转链接",trigger:"blur"}]}}},computed:{uploadUrl(){return this.$http.server_host+"/cmsapi/banner/upload"},uploadHeaders(){return{Authorization:"Bearer "+this.$auth.token}}},mounted(){this.loadBannerList()},methods:{async loadBannerList(){this.loading=!0;try{const e=await this.$http.getBannerList();200===e.code&&(e.data.length>0?this.bannerList=e.data:this.bannerList=[])}catch(e){console.error("加载轮播图列表失败:",e),this.$message.error("加载轮播图列表失败")}finally{this.loading=!1}},openAddDialog(){this.dialogTitle="添加轮播图",this.currentBanner=null,this.dialogVisible=!0},openEditDialog(e){this.dialogTitle="编辑轮播图",this.currentBanner={...e},this.bannerForm={...e},this.dialogVisible=!0},resetForm(){this.bannerForm={name:"",image_url:"",link_url:""},this.currentBanner=null},submitForm(){this.$refs.bannerFormRef.validate(async e=>{if(e)try{let e;e=this.currentBanner?await this.$http.updateBanner({...this.bannerForm,id:this.currentBanner.id}):await this.$http.addBanner(this.bannerForm),200===e.code?(this.$message.success(this.currentBanner?"编辑成功":"添加成功"),this.$http.refreshBanner(),this.dialogVisible=!1,this.resetForm(),this.loadBannerList()):this.$message.error(e.message||(this.currentBanner?"编辑失败":"添加失败"))}catch(t){console.error("保存轮播图失败:",t),this.$message.error("保存轮播图失败")}})},openDeleteDialog(e){this.currentBanner=e,this.deleteBannerVisible=!0},async confirmDelete(){try{const e=await this.$http.deleteBanner(this.currentBanner.id);200===e.code?(this.$message.success("删除成功"),this.$http.refreshBanner(),this.deleteBannerVisible=!1,this.loadBannerList()):this.$message.error(e.message||"删除失败")}catch(e){console.error("删除轮播图失败:",e),this.$message.error("删除轮播图失败")}},beforeUpload(e){const t=e.type.startsWith("image/"),l=e.size/1024/1024<10;return t||this.$message.error("上传图片只能是图片格式!"),l||this.$message.error("上传图片大小不能超过 10MB!"),t&&l},handleUploadSuccess(e){200===e.code?(this.bannerForm.image_url=e.data.image_url,this.$message.success("图片上传成功")):this.$message.error(e.message||"图片上传失败")},handleUploadError(e){this.$message.error("图片上传失败"),console.error("上传失败:",e)}}};const z=(0,g.A)(O,[["render",P],["__scopeId","data-v-36caa676"]]);var q=z;const M={class:"link-management"},j={class:"toolbar"},Q=["href"],K={class:"pagination-container"},H={class:"pagination"},N={class:"dialog-footer"},G={class:"dialog-footer"};function J(e,t,l,o,r,i){const n=(0,a.g2)("el-button"),d=(0,a.g2)("el-table-column"),u=(0,a.g2)("el-tag"),c=(0,a.g2)("el-table"),m=(0,a.g2)("el-pagination"),g=(0,a.g2)("el-input"),h=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-form"),b=(0,a.g2)("el-dialog"),f=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",M,[(0,a.Lk)("div",j,[(0,a.bF)(n,{type:"primary",onClick:i.openAddDialog},{default:(0,a.k6)(()=>[...t[6]||(t[6]=[(0,a.eW)("添加链接",-1)])]),_:1},8,["onClick"])]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{data:r.linkList,style:{width:"100%"}},{default:(0,a.k6)(()=>[(0,a.bF)(d,{prop:"name",label:"链接名称",width:"200"}),(0,a.bF)(d,{prop:"link_url",label:"链接地址","show-overflow-tooltip":""},{default:(0,a.k6)(e=>[(0,a.Lk)("a",{href:e.row.link_url,target:"_blank"},(0,s.v_)(e.row.link_url),9,Q)]),_:1}),(0,a.bF)(d,{prop:"create_time",label:"创建时间",width:"200"},{default:(0,a.k6)(e=>[(0,a.eW)((0,s.v_)(i.formatDate(e.row.create_time)),1)]),_:1}),(0,a.bF)(d,{label:"状态",width:"100"},{default:(0,a.k6)(e=>[(0,a.bF)(u,{type:e.row.is_deployed?"success":"danger"},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_deployed?"已部署":"未部署"),1)]),_:2},1032,["type"])]),_:1}),(0,a.bF)(d,{label:"操作",width:"280"},{default:(0,a.k6)(e=>[(0,a.bF)(n,{size:"small",type:e.row.is_deployed?"danger":"success",onClick:t=>i.toggleDeployStatus(e.row)},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_deployed?"设为未部署":"设为部署"),1)]),_:2},1032,["type","onClick"]),(0,a.bF)(n,{size:"small",type:"success",onClick:t=>i.openEditDialog(e.row)},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,a.bF)(n,{size:"small",type:"danger",onClick:t=>i.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[8]||(t[8]=[(0,a.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[f,r.loading]]),(0,a.Lk)("div",K,[(0,a.Lk)("div",H,[r.total>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,onCurrentChange:i.handlePageChange,"current-page":r.currentPage,layout:"total, prev, pager, next",total:r.total},null,8,["onCurrentChange","current-page","total"])):(0,a.Q3)("",!0)])]),(0,a.bF)(b,{title:r.dialogTitle,modelValue:r.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>r.dialogVisible=e),width:"500px",onClose:i.resetForm},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",N,[(0,a.bF)(n,{onClick:t[2]||(t[2]=e=>r.dialogVisible=!1)},{default:(0,a.k6)(()=>[...t[9]||(t[9]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"primary",onClick:i.submitForm},{default:(0,a.k6)(()=>[...t[10]||(t[10]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(p,{model:r.linkForm,rules:r.formRules,ref:"linkFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{label:"链接名称",prop:"name"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.linkForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.linkForm.name=e),placeholder:"请输入链接名称"},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"链接地址",prop:"link_url"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.linkForm.link_url,"onUpdate:modelValue":t[1]||(t[1]=e=>r.linkForm.link_url=e),placeholder:"请输入链接地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"]),(0,a.bF)(b,{title:"提示",modelValue:r.deleteLinkVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>r.deleteLinkVisible=e),width:"300px",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",G,[(0,a.bF)(n,{onClick:t[4]||(t[4]=e=>r.deleteLinkVisible=!1)},{default:(0,a.k6)(()=>[...t[11]||(t[11]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"danger",onClick:i.confirmDelete},{default:(0,a.k6)(()=>[...t[12]||(t[12]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[t[13]||(t[13]=(0,a.Lk)("span",null,"确定要删除这个链接吗？",-1))]),_:1},8,["modelValue"])])}var Y={name:"LinkManagement",data(){return{loading:!1,linkList:[],total:0,currentPage:1,dialogVisible:!1,deleteLinkVisible:!1,dialogTitle:"添加链接",currentLink:null,linkForm:{name:"",link_url:"",is_deployed:1},formRules:{name:[{required:!0,message:"请输入链接名称",trigger:"blur"}],link_url:[{required:!0,message:"请输入链接地址",trigger:"blur"}]}}},mounted(){this.loadLinkList(1)},methods:{async loadLinkList(e){this.loading=!0;try{const t=await this.$http.getLinkList(e);200===t.code?t.data.link_list.length>0?(this.linkList=t.data.link_list,this.total=t.data.total_count,this.currentPage=e):(this.linkList=[],this.total=0,this.currentPage=1):this.$message.error(t.message||"获取链接列表失败")}catch(t){console.error("加载链接列表失败:",t),this.$message.error("加载链接列表失败")}finally{this.loading=!1}},handlePageChange(e){this.loadLinkList(e)},openAddDialog(){this.dialogTitle="添加链接",this.currentLink=null,this.dialogVisible=!0},openEditDialog(e){this.dialogTitle="编辑链接",this.currentLink={...e},this.linkForm={...e},this.dialogVisible=!0},resetForm(){this.linkForm={name:"",link_url:""},this.currentLink=null,this.$refs.linkFormRef&&this.$refs.linkFormRef.resetFields()},submitForm(){this.$refs.linkFormRef.validate(async e=>{if(e)try{let e;e=this.currentLink?await this.$http.updateLink({...this.linkForm,id:this.currentLink.id}):await this.$http.addLink(this.linkForm),200===e.code?(this.$message.success(this.currentLink?"编辑成功":"添加成功"),this.dialogVisible=!1,this.resetForm(),this.loadLinkList()):this.$message.error(e.message||(this.currentLink?"编辑失败":"添加失败"))}catch(t){console.error("保存链接失败:",t),this.$message.error("保存链接失败")}})},openDeleteDialog(e){this.currentLink=e,this.deleteLinkVisible=!0},async confirmDelete(){try{const e=await this.$http.deleteLink(this.currentLink.id);200===e.code?(this.$message.success("删除成功"),this.deleteLinkVisible=!1,this.loadLinkList()):this.$message.error(e.message||"删除失败")}catch(e){console.error("删除链接失败:",e),this.$message.error("删除链接失败")}},async toggleDeployStatus(e){try{const t=e.is_deployed?0:1,l=await this.$http.activeLink(e.id,t);200===l.code?(this.$message.success((e.is_deployed?"取消部署":"部署")+"成功"),this.loadLinkList()):this.$message.error(l.message||(e.is_deployed?"取消部署":"部署")+"失败")}catch(t){console.error("更新状态失败:",t),this.$message.error("更新状态失败")}},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()}}};const Z=(0,g.A)(Y,[["render",J],["__scopeId","data-v-178ac2fe"]]);var ee=Z;const te={class:"tool-management"},le={class:"toolbar"},oe=["href"],ae={class:"pagination-container"},se={class:"image-upload-container"},re={class:"dialog-footer"},ie={class:"dialog-footer"};function ne(e,t,l,o,r,i){const n=(0,a.g2)("el-button"),d=(0,a.g2)("el-table-column"),u=(0,a.g2)("el-image"),c=(0,a.g2)("el-table"),m=(0,a.g2)("el-pagination"),g=(0,a.g2)("el-input"),h=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-upload"),b=(0,a.g2)("el-option"),f=(0,a.g2)("el-select"),k=(0,a.g2)("el-form"),_=(0,a.g2)("el-dialog"),F=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",te,[(0,a.Lk)("div",le,[(0,a.bF)(n,{type:"primary",onClick:i.openAddDialog},{default:(0,a.k6)(()=>[...t[9]||(t[9]=[(0,a.eW)("添加工具",-1)])]),_:1},8,["onClick"])]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{data:r.toolList,style:{width:"100%"}},{default:(0,a.k6)(()=>[(0,a.bF)(d,{prop:"name",label:"工具名称"}),(0,a.bF)(d,{prop:"description",label:"工具描述","show-overflow-tooltip":""}),(0,a.bF)(d,{label:"工具图标"},{default:(0,a.k6)(t=>[t.row.icon_url?((0,a.uX)(),(0,a.Wv)(u,{key:0,src:e.$http.server_host+t.row.icon_url,fit:"cover",style:{width:"40px",height:"40px"}},null,8,["src"])):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(d,{prop:"link_url",label:"工具链接","show-overflow-tooltip":""},{default:(0,a.k6)(e=>[(0,a.Lk)("a",{href:e.row.link_url,target:"_blank"},(0,s.v_)(e.row.link_url),9,oe)]),_:1}),(0,a.bF)(d,{prop:"type.name",label:"工具分类"}),(0,a.bF)(d,{label:"操作",width:"200"},{default:(0,a.k6)(e=>[(0,a.bF)(n,{size:"small",onClick:t=>i.openEditDialog(e.row)},{default:(0,a.k6)(()=>[...t[10]||(t[10]=[(0,a.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,a.bF)(n,{size:"small",type:"danger",onClick:t=>i.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[11]||(t[11]=[(0,a.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,r.loading]]),(0,a.Lk)("div",ae,[r.total>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,onCurrentChange:i.handlePageChange,"current-page":r.currentPage,"page-size":r.pageSize,layout:"total, prev, pager, next",total:r.total},null,8,["onCurrentChange","current-page","page-size","total"])):(0,a.Q3)("",!0)]),(0,a.bF)(_,{title:r.dialogTitle,modelValue:r.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>r.dialogVisible=e),width:"500px",onClose:i.resetForm},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",re,[(0,a.bF)(n,{onClick:t[5]||(t[5]=e=>r.dialogVisible=!1)},{default:(0,a.k6)(()=>[...t[13]||(t[13]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"primary",onClick:i.submitForm},{default:(0,a.k6)(()=>[...t[14]||(t[14]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(k,{model:r.toolForm,rules:r.formRules,ref:"toolFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{label:"工具名称",prop:"name"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.toolForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.toolForm.name=e),placeholder:"请输入工具名称"},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"工具描述",prop:"description"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.toolForm.description,"onUpdate:modelValue":t[1]||(t[1]=e=>r.toolForm.description=e),type:"textarea",placeholder:"请输入工具描述",rows:3},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"工具图标",prop:"icon_url"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",se,[(0,a.bF)(g,{modelValue:r.toolForm.icon_url,"onUpdate:modelValue":t[2]||(t[2]=e=>r.toolForm.icon_url=e),placeholder:"请输入图标URL或上传图标",style:{"margin-right":"10px"}},null,8,["modelValue"]),(0,a.bF)(p,{class:"upload-demo",action:e.$http.server_host+"/cmsapi/tool/icon/upload",headers:i.uploadHeaders,name:"icon_url","show-file-list":!1,"on-success":i.handleUploadSuccess,"on-error":i.handleUploadError,"before-upload":i.beforeUpload,accept:"image/jpeg,image/png,image/jpg,image/svg+xml"},{default:(0,a.k6)(()=>[(0,a.bF)(n,{type:"primary",size:"small"},{default:(0,a.k6)(()=>[...t[12]||(t[12]=[(0,a.eW)("上传图标",-1)])]),_:1})]),_:1},8,["action","headers","on-success","on-error","before-upload"])])]),_:1}),(0,a.bF)(h,{label:"工具链接",prop:"link_url"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.toolForm.link_url,"onUpdate:modelValue":t[3]||(t[3]=e=>r.toolForm.link_url=e),placeholder:"请输入工具链接"},null,8,["modelValue"])]),_:1}),(0,a.bF)(h,{label:"工具分类",prop:"type_name"},{default:(0,a.k6)(()=>[(0,a.bF)(f,{modelValue:r.toolForm.type_name,"onUpdate:modelValue":t[4]||(t[4]=e=>r.toolForm.type_name=e),placeholder:"请选择工具分类",style:{width:"100%"}},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.toolTypeList,e=>((0,a.uX)(),(0,a.Wv)(b,{key:e.name,label:e.name,value:e.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"]),(0,a.bF)(_,{title:"提示",modelValue:r.deleteToolVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>r.deleteToolVisible=e),width:"300px",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",ie,[(0,a.bF)(n,{onClick:t[7]||(t[7]=e=>r.deleteToolVisible=!1)},{default:(0,a.k6)(()=>[...t[15]||(t[15]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"danger",onClick:i.confirmDelete},{default:(0,a.k6)(()=>[...t[16]||(t[16]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[t[17]||(t[17]=(0,a.Lk)("span",null,"确定要删除这个工具吗？",-1))]),_:1},8,["modelValue"])])}var de={name:"ToolManagement",data(){return{loading:!1,toolList:[],toolTypeList:[],total:0,currentPage:1,pageSize:10,dialogVisible:!1,deleteToolVisible:!1,dialogTitle:"添加工具",currentTool:null,toolForm:{name:"",description:"",icon_url:"",link_url:"",type_name:""},formRules:{name:[{required:!0,message:"请输入工具名称",trigger:"blur"}],description:[{required:!0,message:"请输入工具描述",trigger:"blur"}],icon_url:[{required:!0,message:"请上传工具图标",trigger:"blur"}],link_url:[{required:!0,message:"请输入工具链接",trigger:"blur"}],type_name:[{required:!0,message:"请选择工具分类",trigger:"change"}]}}},computed:{uploadHeaders(){return{Authorization:"Bearer "+this.$auth.token}}},mounted(){this.loadToolList(),this.loadToolTypeList()},methods:{async loadToolList(){this.loading=!0;try{const e=await this.$http.getToolList(this.currentPage);200===e.code?(this.toolList=e.data.tool_list||[],this.total=e.data.total_count||0):this.$message.error(e.message||"获取工具列表失败")}catch(e){console.error("加载工具列表失败:",e),this.$message.error("加载工具列表失败")}finally{this.loading=!1}},async loadToolTypeList(){try{const e=await this.$http.getToolTypeList();200===e.code?e.data.length>0?this.toolTypeList=e.data:this.toolTypeList=[]:this.$message.error(e.message||"获取工具分类列表失败")}catch(e){console.error("加载工具分类列表失败:",e),this.$message.error("加载工具分类列表失败")}},handlePageChange(e){this.currentPage=e,this.loadToolList()},openAddDialog(){this.dialogTitle="添加工具",this.currentTool=null,this.dialogVisible=!0},openEditDialog(e){this.dialogTitle="编辑工具",this.currentTool={...e},console.log(e),this.toolForm={name:e.name,description:e.description,icon_url:e.icon_url,link_url:e.link_url,type_name:e.type?.name||""},this.dialogVisible=!0},resetForm(){this.toolForm={name:"",description:"",icon_url:"",link_url:"",type_name:""},this.currentTool=null,this.$refs.toolFormRef&&this.$refs.toolFormRef.resetFields()},submitForm(){this.$refs.toolFormRef.validate(async e=>{if(e)try{let e;e=this.currentTool?await this.$http.updateTool({...this.toolForm,id:this.currentTool.id}):await this.$http.addTool(this.toolForm),200===e.code?(this.$message.success(this.currentTool?"编辑成功":"添加成功"),this.dialogVisible=!1,this.resetForm(),this.loadToolList()):this.$message.error(e.message||(this.currentTool?"编辑失败":"添加失败"))}catch(t){console.error("保存工具失败:",t),this.$message.error("保存工具失败")}})},openDeleteDialog(e){this.currentTool=e,this.deleteToolVisible=!0},async confirmDelete(){try{const e=await this.$http.deleteTool(this.currentTool.id);200===e.code?(this.$message.success("删除成功"),this.deleteToolVisible=!1,this.loadToolList()):this.$message.error(e.message||"删除失败")}catch(e){console.error("删除工具失败:",e),this.$message.error("删除工具失败")}},beforeUpload(e){const t=e.type.startsWith("image/"),l=e.size/1024/1024<10;return t||this.$message.error("上传图标只能是图片格式!"),l||this.$message.error("上传图标大小不能超过 10MB!"),t&&l},handleUploadSuccess(e){console.log("上传成功:",e),200===e.code?(this.toolForm.icon_url=e.data.icon_url,this.$message.success("图标上传成功")):this.$message.error(e.message||"图标上传失败")},handleUploadError(e){this.$message.error("图标上传失败"),console.error("上传失败:",e)}}};const ue=(0,g.A)(de,[["render",ne],["__scopeId","data-v-527fdfaf"]]);var ce=ue;const me={class:"tool-type"},ge={class:"toolbar"},he=["innerHTML"],pe=["innerHTML"],be={style:{"margin-left":"10px"}},fe={class:"dialog-footer"},ke={class:"dialog-footer"};function _e(e,t,l,o,r,i){const n=(0,a.g2)("el-button"),d=(0,a.g2)("el-table-column"),u=(0,a.g2)("el-table"),c=(0,a.g2)("el-input"),m=(0,a.g2)("el-form-item"),g=(0,a.g2)("el-input-number"),h=(0,a.g2)("el-option"),p=(0,a.g2)("el-select"),b=(0,a.g2)("el-form"),f=(0,a.g2)("el-dialog"),k=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",me,[(0,a.Lk)("div",ge,[(0,a.bF)(n,{type:"primary",onClick:i.openAddDialog},{default:(0,a.k6)(()=>[...t[7]||(t[7]=[(0,a.eW)("添加分类",-1)])]),_:1},8,["onClick"])]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(u,{data:r.toolTypeList,style:{width:"100%"}},{default:(0,a.k6)(()=>[(0,a.bF)(d,{prop:"name",label:"分类名称"}),(0,a.bF)(d,{prop:"priority",label:"优先级"}),(0,a.bF)(d,{label:"图标"},{default:(0,a.k6)(e=>[(0,a.Lk)("span",{innerHTML:e.row.icon},null,8,he)]),_:1}),(0,a.bF)(d,{prop:"create_time",label:"创建时间"},{default:(0,a.k6)(e=>[(0,a.eW)((0,s.v_)(i.formatDate(e.row.create_time)),1)]),_:1}),(0,a.bF)(d,{label:"操作",width:"150"},{default:(0,a.k6)(e=>[(0,a.bF)(n,{size:"small",type:"danger",onClick:t=>i.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[8]||(t[8]=[(0,a.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[k,r.loading]]),(0,a.bF)(f,{title:"添加工具分类",modelValue:r.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>r.dialogVisible=e),width:"500px",onClose:i.resetForm},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",fe,[(0,a.bF)(n,{onClick:t[3]||(t[3]=e=>r.dialogVisible=!1)},{default:(0,a.k6)(()=>[...t[9]||(t[9]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"primary",onClick:i.submitForm},{default:(0,a.k6)(()=>[...t[10]||(t[10]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.bF)(b,{model:r.toolTypeForm,rules:r.formRules,ref:"toolTypeFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{label:"分类名称",prop:"name"},{default:(0,a.k6)(()=>[(0,a.bF)(c,{modelValue:r.toolTypeForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.toolTypeForm.name=e),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),(0,a.bF)(m,{label:"优先级",prop:"priority"},{default:(0,a.k6)(()=>[(0,a.bF)(g,{modelValue:r.toolTypeForm.priority,"onUpdate:modelValue":t[1]||(t[1]=e=>r.toolTypeForm.priority=e),min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1}),(0,a.bF)(m,{label:"图标",prop:"icon"},{default:(0,a.k6)(()=>[(0,a.bF)(p,{modelValue:r.toolTypeForm.iconKey,"onUpdate:modelValue":t[2]||(t[2]=e=>r.toolTypeForm.iconKey=e),placeholder:"请选择图标"},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.iconOptions,e=>((0,a.uX)(),(0,a.Wv)(h,{key:e.key,label:e.label,value:e.key},{default:(0,a.k6)(()=>[(0,a.Lk)("span",{innerHTML:e.html},null,8,pe),(0,a.Lk)("span",be,(0,s.v_)(e.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","onClose"]),(0,a.bF)(f,{title:"提示",modelValue:r.deleteToolTypeVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>r.deleteToolTypeVisible=e),width:"300px",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",ke,[(0,a.bF)(n,{onClick:t[5]||(t[5]=e=>r.deleteToolTypeVisible=!1)},{default:(0,a.k6)(()=>[...t[11]||(t[11]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(n,{type:"danger",onClick:i.confirmToolTypeDelete},{default:(0,a.k6)(()=>[...t[12]||(t[12]=[(0,a.eW)("确定",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[t[13]||(t[13]=(0,a.Lk)("span",null,"确定要删除这个工具分类吗？",-1))]),_:1},8,["modelValue"])])}l(116);var Fe={name:"ToolType",data(){return{loading:!1,toolTypeList:[],dialogVisible:!1,deleteToolTypeVisible:!1,currentToolType:null,toolTypeForm:{name:"",priority:0,iconKey:""},formRules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],priority:[{required:!0,message:"请输入优先级",trigger:"blur"}],iconKey:[{required:!0,message:"请选择图标",trigger:"change"}]},iconOptions:[{key:"star",label:"星星",html:'<i class="fas fa-star me-2 text-warning"></i>'},{key:"heart",label:"心形",html:'<i class="fas fa-heart me-2 text-danger"></i>'},{key:"cloud",label:"云朵",html:'<i class="fas fa-cloud me-2 text-info"></i>'},{key:"code",label:"代码",html:'<i class="fas fa-code me-2 text-danger"></i>'},{key:"cog",label:"齿轮",html:'<i class="fas fa-cog me-2 text-secondary"></i>'},{key:"chart",label:"图像",html:'<i class="fas fa-image me-2 text-success"></i>'},{key:"user",label:"用户",html:'<i class="fas fa-user me-2 text-primary"></i>'},{key:"file",label:"文档",html:'<i class="fas fa-file-alt me-2 text-primary"></i>'},{key:"qrcode",label:"二维码",html:'<i class="fas fa-qrcode me-2 text-secondary"></i>'}]}},mounted(){this.loadToolTypeList()},methods:{async loadToolTypeList(){this.loading=!0;try{const e=await this.$http.getToolTypeList();200===e.code?e.data.length>0?this.toolTypeList=e.data:this.toolTypeList=[]:this.$message.error(e.message||"获取工具分类列表失败")}catch(e){this.$message.error("获取工具分类列表失败")}finally{this.loading=!1}},openAddDialog(){this.dialogVisible=!0},resetForm(){this.toolTypeForm={name:"",priority:0,iconKey:""},this.currentToolType=null,this.$refs.toolTypeFormRef&&this.$refs.toolTypeFormRef.resetFields()},submitForm(){this.$refs.toolTypeFormRef.validate(async e=>{if(e)try{const e=this.iconOptions.find(e=>e.key===this.toolTypeForm.iconKey),t={name:this.toolTypeForm.name,priority:this.toolTypeForm.priority,icon:e?e.html:""},l=await this.$http.addToolType(t);200===l.code?(this.$message.success("添加成功"),this.dialogVisible=!1,this.resetForm(),this.loadToolTypeList()):this.$message.error(l.message||"添加失败")}catch(t){this.$message.error("添加工具分类失败")}})},openDeleteDialog(e){this.currentToolType=e,this.deleteToolTypeVisible=!0},async confirmToolTypeDelete(){try{const e=await this.$http.deleteToolType(this.currentToolType.id);200===e.code?(this.$message.success("删除成功"),this.deleteToolTypeVisible=!1,this.loadToolTypeList()):this.$message.error(e.message||"删除失败")}catch(e){this.$message.error("删除工具分类失败")}},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()}}};const ye=(0,g.A)(Fe,[["render",_e],["__scopeId","data-v-375e9a3e"]]);var ve=ye;const we={class:"announcement-list"},Le={class:"content-preview text-muted"},Ve={class:"pagination-container"},Ue={class:"delete-confirm-content"},Te={class:"dialog-footer"};function Ce(e,t,l,o,r,i){const n=(0,a.g2)("el-table-column"),d=(0,a.g2)("el-tag"),u=(0,a.g2)("el-button"),c=(0,a.g2)("el-table"),m=(0,a.g2)("el-pagination"),g=(0,a.g2)("el-card"),h=(0,a.g2)("Warning"),p=(0,a.g2)("el-icon"),b=(0,a.g2)("el-dialog"),f=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",we,[(0,a.bF)(g,{class:"announcement-card"},{header:(0,a.k6)(()=>[...t[2]||(t[2]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",null,"公告列表")],-1)])]),default:(0,a.k6)(()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(c,{data:r.announcementList,style:{width:"100%"},stripe:""},{default:(0,a.k6)(()=>[(0,a.bF)(n,{prop:"title",label:"标题",width:"200"}),(0,a.bF)(n,{label:"内容","min-width":"300"},{default:(0,a.k6)(e=>[(0,a.Lk)("div",Le,(0,s.v_)(e.row.text_muted),1)]),_:1}),(0,a.bF)(n,{prop:"author.realname",label:"发布者",width:"120"}),(0,a.bF)(n,{label:"状态",width:"100"},{default:(0,a.k6)(e=>[(0,a.bF)(d,{type:e.row.is_active?"success":"danger"},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_active?"已激活":"未激活"),1)]),_:2},1032,["type"])]),_:1}),(0,a.bF)(n,{label:"操作",width:"200"},{default:(0,a.k6)(e=>[(0,a.bF)(u,{size:"small",type:e.row.is_active?"warning":"success",onClick:t=>i.toggleStatus(e.row)},{default:(0,a.k6)(()=>[(0,a.eW)((0,s.v_)(e.row.is_active?"设为未激活":"设为激活"),1)]),_:2},1032,["type","onClick"]),(0,a.bF)(u,{size:"small",type:"danger",onClick:t=>i.openDeleteDialog(e.row)},{default:(0,a.k6)(()=>[...t[3]||(t[3]=[(0,a.eW)(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[f,r.loading]]),(0,a.Lk)("div",Ve,[r.total>0?((0,a.uX)(),(0,a.Wv)(m,{key:0,onCurrentChange:i.handlePageChange,"current-page":r.currentPage,"page-size":r.pageSize,layout:"total, prev, pager, next",total:r.total},null,8,["onCurrentChange","current-page","page-size","total"])):(0,a.Q3)("",!0)])]),_:1}),(0,a.bF)(b,{title:"确认删除",modelValue:r.deleteDialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>r.deleteDialogVisible=e),width:"30%",center:""},{footer:(0,a.k6)(()=>[(0,a.Lk)("span",Te,[(0,a.bF)(u,{onClick:t[0]||(t[0]=e=>r.deleteDialogVisible=!1)},{default:(0,a.k6)(()=>[...t[5]||(t[5]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(u,{type:"danger",onClick:i.confirmDelete},{default:(0,a.k6)(()=>[...t[6]||(t[6]=[(0,a.eW)("确定删除",-1)])]),_:1},8,["onClick"])])]),default:(0,a.k6)(()=>[(0,a.Lk)("div",Ue,[(0,a.bF)(p,{class:"delete-icon"},{default:(0,a.k6)(()=>[(0,a.bF)(h)]),_:1}),t[4]||(t[4]=(0,a.Lk)("span",null,"确定要删除公告吗？",-1))])]),_:1},8,["modelValue"])])}var $e={name:"AnnouncementList",data(){return{loading:!1,announcementList:[],total:0,currentPage:1,pageSize:10,deleteDialogVisible:!1,currentAnnouncement:null}},mounted(){this.loadAnnouncementList()},methods:{async loadAnnouncementList(){this.loading=!0;try{const e=await this.$http.getAnnounceList(this.currentPage);200===e.code?(this.announcementList=e.data.announce_list||[],this.total=e.data.total_count||0):this.$message.error(e.message||"获取公告列表失败")}catch(e){console.error("获取公告列表失败:",e),this.$message.error("获取公告列表失败")}finally{this.loading=!1}},handlePageChange(e){this.currentPage=e,this.loadAnnouncementList()},toggleStatus(e){let t=e.is_active?0:1;this.$http.activeAnnounce(e.id,t).then(t=>{console.log("更新状态成功:",t),200===t.code?(this.$message.success((e.is_active?"取消激活":"激活")+"成功"),this.loadAnnouncementList()):this.$message.error(t.message||(e.is_active?"取消激活":"激活")+"失败")}).catch(e=>{console.error("更新状态失败:",e),this.$message.error("更新状态失败")})},openDeleteDialog(e){this.currentAnnouncement=e,this.deleteDialogVisible=!0},async confirmDelete(){try{const e=await this.$http.deleteAnnounce(this.currentAnnouncement.id);200===e.code?(this.$message.success("删除成功"),this.deleteDialogVisible=!1,this.loadAnnouncementList()):this.$message.error(e.message||"删除失败")}catch(e){console.error("删除失败:",e),this.$message.error("删除失败")}}}};const We=(0,g.A)($e,[["render",Ce],["__scopeId","data-v-7906015d"]]);var xe=We;const De={class:"announcement-add"},Re={style:{border:"1px solid #ccc"}};function Ae(e,t,l,o,s,r){const i=(0,a.g2)("el-input"),n=(0,a.g2)("el-form-item"),d=(0,a.g2)("Toolbar"),u=(0,a.g2)("Editor"),c=(0,a.g2)("el-button"),m=(0,a.g2)("el-form"),g=(0,a.g2)("el-card");return(0,a.uX)(),(0,a.CE)("div",De,[(0,a.bF)(g,{class:"announcement-card"},{header:(0,a.k6)(()=>[...t[2]||(t[2]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",null,"发布公告")],-1)])]),default:(0,a.k6)(()=>[(0,a.bF)(m,{model:s.announcementForm,rules:s.formRules,ref:"announcementFormRef","label-width":"100px"},{default:(0,a.k6)(()=>[(0,a.bF)(n,{label:"公告标题",prop:"title"},{default:(0,a.k6)(()=>[(0,a.bF)(i,{modelValue:s.announcementForm.title,"onUpdate:modelValue":t[0]||(t[0]=e=>s.announcementForm.title=e),placeholder:"请输入公告标题",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),(0,a.bF)(n,{label:"公告内容",prop:"content"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",Re,[(0,a.bF)(d,{style:{"border-bottom":"1px solid #ccc"},editor:o.editorRef,defaultConfig:o.toolbarConfig,mode:o.mode},null,8,["editor","defaultConfig","mode"]),(0,a.bF)(u,{style:{height:"500px","overflow-y":"hidden"},modelValue:s.announcementForm.content,"onUpdate:modelValue":t[1]||(t[1]=e=>s.announcementForm.content=e),defaultConfig:o.editorConfig,mode:o.mode,onOnCreated:o.handleCreated},null,8,["modelValue","defaultConfig","mode","onOnCreated"])])]),_:1}),(0,a.bF)(n,null,{default:(0,a.k6)(()=>[(0,a.bF)(c,{type:"primary",onClick:r.submitForm},{default:(0,a.k6)(()=>[...t[3]||(t[3]=[(0,a.eW)("发布",-1)])]),_:1},8,["onClick"]),(0,a.bF)(c,{onClick:r.resetForm},{default:(0,a.k6)(()=>[...t[4]||(t[4]=[(0,a.eW)("重置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}var Be=l(144),Ie=l(6925),Se={name:"AnnouncementAdd",components:{Editor:Ie.K,Toolbar:Ie.M},setup(){const e=(0,Be.IJ)(),t={excludeKeys:["group-image","group-video","todo"]},l={placeholder:"请输入内容..."};(0,a.xo)(()=>{const t=e.value;null!=t&&t.destroy()});const o=t=>{e.value=t};return{editorRef:e,mode:"default",toolbarConfig:t,editorConfig:l,handleCreated:o}},data(){return{announcementForm:{title:"",content:""},formRules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}]},announcementFormRef:null}},methods:{submitForm(){this.$refs.announcementFormRef.validate(async e=>{if(e)try{const e=await this.$http.addAnnounce(this.announcementForm);200===e.code?(this.$message.success("公告发布成功"),this.resetForm(),this.$router.push({name:"announcelist"})):this.$message.error(e.message||"公告发布失败")}catch(t){console.error("发布公告失败:",t),this.$message.error("公告发布失败")}})},resetForm(){this.$refs.announcementFormRef.resetFields(),this.announcementForm.content=""}}};const Ee=(0,g.A)(Se,[["render",Ae],["__scopeId","data-v-51b4545b"]]);var Xe=Ee;const Pe=[{path:"/",component:L,name:"home"},{path:"/users",component:A,name:"users"},{path:"/banners",component:q,name:"banners"},{path:"/links",component:ee,name:"links"},{path:"/tools",name:"tools",redirect:"/tools/list",children:[{path:"list",component:ce,name:"toolmanagement"},{path:"type",component:ve,name:"tooltype"}]},{path:"/announcements",name:"announcements",redirect:"/announcements/list",children:[{path:"list",component:xe,name:"announcelist"},{path:"add",component:Xe,name:"announceadd"}]}],Oe=(0,k.aE)({history:(0,k.LA)(),routes:Pe});var ze=Oe;const qe="USER_KEY",Me="JWT_TOKEN_KEY";class je{constructor(){this.token=null,this.user=null,this.token=localStorage.getItem(Me);const e=localStorage.getItem(qe);e&&(this.user=JSON.parse(e))}static getInstance(){return this._instance||(this._instance=new je),this._instance}setUserToken(e,t){this.user=e,this.token=t,localStorage.setItem(qe,JSON.stringify(e)),localStorage.setItem(Me,t)}clearUserToken(){this.user=null,this.token=null,localStorage.removeItem(qe),localStorage.removeItem(Me)}get is_authed(){return!(!this.user||!this.token)}get is_active(){return!!this.is_authed&&!!this.user.is_active}}var Qe=je.getInstance(),Ke=l(4373),He=l(9122),Ne=l.n(He);class Ge{constructor(){this.server_host=window.location.origin,this.http=Ke.A.create({baseURL:this.server_host+"/cmsapi",timeout:6e4}),this.http.interceptors.request.use(e=>{const t=Qe.token;return t&&(e.headers.Authorization="Bearer "+t),e}),this.http.interceptors.response.use(e=>e.data)}_post(e,t){return this.http.post(e,Ne().stringify(t))}addBanner(e){const t="/banner/add";return this._post(t,e)}getBannerList(){const e="/banner/list";return this.http.get(e)}deleteBanner(e){const t="/banner/delete";return this._post(t,{id:e})}updateBanner(e){const t="/banner/update";return this._post(t,e)}refreshBanner(){const e="/banner/refresh";return this.http.get(e)}getAnnounceList(e){const t="/announce/list?page="+(e||1);return this.http.get(t)}addAnnounce(e){const t="/announce/add";return this._post(t,e)}deleteAnnounce(e){const t="/announce/delete";return this._post(t,{id:e})}activeAnnounce(e,t){const l="/announce/active?id="+e+"&is_active="+t;return this._post(l,{id:e,is_active:t})}getCommentList(e){const t="/comment/list?page="+(e||1);return this.http.get(t)}deleteComment(e){const t="/comment/delete";return this._post(t,{id:e})}getToolTypeList(){const e="/tooltype/list";return this.http.get(e)}addToolType(e){const t="/tooltype/add";return this._post(t,e)}deleteToolType(e){const t="/tooltype/delete";return this._post(t,{id:e})}getToolList(e){const t="/tool/list?page="+(e||1);return this.http.get(t)}addTool(e){const t="/tool/add";return this._post(t,e)}deleteTool(e){const t="/tool/delete";return this._post(t,{id:e})}updateTool(e){const t="/tool/update";return this._post(t,e)}getLinkList(e){const t="/link/list?page="+(e||1);return this.http.get(t)}addLink(e){const t="/link/add";return this._post(t,e)}deleteLink(e){const t="/link/delete";return this._post(t,{id:e})}updateLink(e){const t="/link/update";return this._post(t,e)}activeLink(e,t){const l="/link/deploy/status?id="+e+"&is_deployed="+t;return this._post(l,{id:e,is_deployed:t})}getUserList(e){const t="/user/list?page="+(e||1);return this.http.get(t)}activeUser(e,t){const l="/user/active?id="+e+"&is_active="+t;return this._post(l,{id:e,is_active:t})}addUser(e){const t="/user/add";return this._post(t,e)}deleteUser(e){const t="/user/delete";return this._post(t,{id:e})}updateUserRole(e){const t="/user/update/role";return this._post(t,e)}getSysInfo(){const e="/sys/useage";return this.http.get(e)}getToolMemu(){const e="/tool/menu";return this.http.get(e)}getToolUsageCount(){const e="/tool/usage/count";return this.http.get(e)}getWebAccessInfo(){const e="/web/access/info";return this.http.get(e)}}var Je=new Ge;const Ye=(0,o.Ef)(p);for(const[Ze,et]of Object.entries(b))Ye.component(Ze,et);Ye.use(f.A),Ye.use(ze),Ye.config.globalProperties.$auth=Qe,Ye.config.globalProperties.$http=Je,Ye.mount("#app")}},t={};function l(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,l),s.exports}l.m=e,function(){var e=[];l.O=function(t,o,a,s){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],s=e[u][2];for(var i=!0,n=0;n<o.length;n++)(!1&s||r>=s)&&Object.keys(l.O).every(function(e){return l.O[e](o[n])})?o.splice(n--,1):(i=!1,s<r&&(r=s));if(i){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,a,s]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,s,r=o[0],i=o[1],n=o[2],d=0;if(r.some(function(t){return 0!==e[t]})){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);if(n)var u=n(l)}for(t&&t(o);d<r.length;d++)s=r[d],l.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return l.O(u)},o=self["webpackChunkpersonalweb_cms"]=self["webpackChunkpersonalweb_cms"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=l.O(void 0,[504],function(){return l(4125)});o=l.O(o)})();
//# sourceMappingURL=app.d756092a.js.map